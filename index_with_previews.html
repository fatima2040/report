
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>تقرير برنامج</title>
  <style>
    body { font-family: 'Arial', sans-serif; direction: rtl; text-align: center; background: #fdfdfd; margin: 0; padding: 0; }
    .container { max-width: 800px; margin: auto; padding: 20px; background: white; }
    img.header, img.footer { width: 100%; }
    .input-group { margin: 10px 0; text-align: right; padding: 0 10px; }
    label { display: block; font-weight: bold; margin-bottom: 5px; }
    input[type="text"], input[type="date"], textarea, select {
      width: 100%; padding: 8px; font-size: 14px;
      border: 1px solid #ccc; border-radius: 5px;
      text-align: center;
    }
    .image-upload-block {
      display: inline-block;
      margin: 10px;
      text-align: center;
    }
    .image-preview {
      margin-top: 10px;
    }
    .image-preview img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
      border: 1px solid #999;
      cursor: pointer;
    }
    .hidden { display: none; }
    button {
      margin: 30px auto 10px;
      background: #28a745; color: white;
      border: none; padding: 12px 24px;
      border-radius: 6px; font-size: 15px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="container" id="report">
  <img src="header.png" class="header" alt="هيدر المدرسة">

  <div class="input-group">
    <label>📌 عنوان النشاط:</label>
    <input type="text" placeholder="اكتبي عنوان النشاط">
  </div>

  <div class="input-group">
    <label>🎯 الهدف العام:</label>
    <input type="text" placeholder="اكتبي الهدف العام">
  </div>

  <div class="input-group">
    <label>🎨 الهدف التفصيلي:</label>
    <input type="text" placeholder="اكتبي الهدف التفصيلي">
  </div>

  <div class="input-group">
    <label>📝 الوصف:</label>
    <textarea rows="3" placeholder="اكتبي وصف البرنامج..."></textarea>
  </div>

  <div class="input-group">
    <label>🧠 عدد المستفيدات والفئة المستهدفة:</label>
    <input type="text" placeholder="مثال: الصف الأول - 40 طالبة">
  </div>

  <div class="input-group">
    <label>📅 تاريخ التنفيذ:</label>
    <input type="date">
  </div>

  <div class="input-group">
    <label>✍️ اسم معدة التقرير:</label>
    <input type="text" placeholder="مثال: اكتبِ اسمك هنا">
  </div>

  <div class="input-group">
    <label>📎 الشواهد (اختاري عدد الصور):</label>
    <select id="imageCount" onchange="showImageInputs(this.value)">
      <option value="0">-- اختاري عدد الصور --</option>
      <option value="1">1 صورة</option>
      <option value="2">2 صورتين</option>
      <option value="3">3 صور</option>
      <option value="4">4 صور</option>
    </select>
  </div>

  <div id="imageInputs" class="input-group hidden"></div>

  <img src="footer.png" class="footer" alt="فوتر المدرسة">
  <button onclick="window.print()">📄 تحميل التقرير PDF</button>
</div>

<script>
  const uploadURL = "https://script.google.com/macros/s/AKfycbw8DZ_uP1kFLcIv3O1BiVrzbyo7US7eENhAWiXf9xTNwmg8gwhh4F7mcIMaIM8CxogPZA/exec";

  function showImageInputs(count) {
    const container = document.getElementById("imageInputs");
    container.innerHTML = "";
    container.classList.toggle("hidden", count == 0);

    for (let i = 0; i < count; i++) {
      const block = document.createElement("div");
      block.className = "image-upload-block";

      const input = document.createElement("input");
      input.type = "file";
      input.accept = "image/*";
      input.onchange = (e) => handleImageUpload(e.target.files[0], preview);

      const preview = document.createElement("div");
      preview.className = "image-preview";

      block.appendChild(input);
      block.appendChild(preview);
      container.appendChild(block);
    }
  }

  function handleImageUpload(file, previewContainer) {
    const reader = new FileReader();
    reader.onload = function (e) {
      const base64 = e.target.result.split(",")[1];
      fetch(uploadURL, {
        method: "POST",
        body: new URLSearchParams({
          image: base64,
          name: file.name,
          mimeType: file.type
        })
      })
      .then(res => res.text())
      .then(url => {
        const img = document.createElement("img");
        img.src = url;
        img.onclick = () => window.open(url, "_blank");
        previewContainer.innerHTML = "";
        previewContainer.appendChild(img);
      });
    };
    reader.readAsDataURL(file);
  }
</script>

</body>
</html>
